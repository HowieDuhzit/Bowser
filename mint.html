<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mint NFT - Bowser AI</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="https://unpkg.com/@solana/spl-token@0.3.8/lib/index.iife.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@metaplex-foundation/js@0.19.4/dist/browser-global.min.js"></script>
    <style>
        .mint-container {
            max-width: 800px;
            margin: 100px auto;
            padding: 2rem;
            text-align: center;
        }

        .wallet-section {
            margin: 2rem 0;
        }

        .mint-button, .connect-wallet-button {
            background: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            margin: 1rem 0;
            transition: transform 0.3s ease;
        }

        .mint-button:hover, .connect-wallet-button:hover {
            transform: translateY(-3px);
        }

        .mint-button:disabled {
            background: #666;
            cursor: not-allowed;
        }

        .nft-preview {
            max-width: 300px;
            margin: 2rem auto;
            border-radius: 10px;
            overflow: hidden;
        }

        .nft-preview img {
            width: 100%;
            height: auto;
        }

        .wallet-status {
            margin: 1rem 0;
            padding: 1rem;
            border-radius: 10px;
            background: var(--card-bg);
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo-container">
                <img src="bowser-icon.png" alt="Bowser AI Icon">
                <div class="logo">Bowser AI</div>
            </div>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="tos.html">Terms of Service</a></li>
                <li><a href="privacy.html">Privacy Policy</a></li>
            </ul>
        </nav>
    </header>

    <div class="mint-container">
        <h1>Mint Your Bowser NFT</h1>
        
        <div class="nft-preview">
            <img src="bowser-nft-preview.png" alt="Bowser NFT Preview">
        </div>

        <div class="wallet-section">
            <div id="wallet-status" class="wallet-status">
                Wallet not connected
            </div>
            <button id="connect-wallet" class="connect-wallet-button">Connect Phantom Wallet</button>
        </div>

        <div class="mint-section">
            <button id="mint-button" class="mint-button" disabled>Mint NFT (0.1 SOL)</button>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <a href="index.html">Home</a>
                <a href="tos.html">Terms of Service</a>
                <a href="privacy.html">Privacy Policy</a>
            </div>
            <p>&copy; 2024 Bowser AI. All rights reserved.</p>
        </div>
    </footer>

    <script>
        let walletAddress = null;
        let connection = null;
        const NETWORK = 'devnet'; // or 'mainnet-beta' for production
        const MINT_PRICE = 0.1; // SOL
        const NFT_PROGRAM_ID = 'YOUR_NFT_PROGRAM_ID'; // Replace with your program ID
        
        async function initializeConnection() {
            const endpoint = NETWORK === 'devnet' 
                ? 'https://api.devnet.solana.com' 
                : 'https://api.mainnet-beta.solana.com';
            connection = new solanaWeb3.Connection(endpoint);
        }

        async function connectWallet() {
            try {
                // Check if Phantom is installed
                const { solana } = window;
                
                if (!solana?.isPhantom) {
                    alert('Phantom wallet is not installed. Please install it first.');
                    window.open('https://phantom.app/', '_blank');
                    return;
                }

                // Connect to wallet
                await solana.connect();
                
                if (!connection) {
                    await initializeConnection();
                }

                walletAddress = solana.publicKey.toString();
                
                // Update UI
                const walletStatus = document.getElementById('wallet-status');
                walletStatus.textContent = `Connected: ${walletAddress.slice(0, 4)}...${walletAddress.slice(-4)}`;
                document.getElementById('mint-button').disabled = false;

                // Add disconnect handler
                solana.on('disconnect', () => {
                    walletAddress = null;
                    walletStatus.textContent = 'Wallet not connected';
                    document.getElementById('mint-button').disabled = true;
                });

            } catch (err) {
                console.error(err);
                alert('Failed to connect wallet: ' + err.message);
            }
        }

        async function mintNFT() {
            try {
                if (!walletAddress) {
                    alert('Please connect your wallet first');
                    return;
                }

                const { solana } = window;
                
                // Create the token metadata
                const metadata = {
                    name: "Bowser AI NFT",
                    symbol: "BWSR",
                    description: "Official Bowser AI NFT Collection",
                    image: "https://your-metadata-uri.com/nft-image.png", // Replace with your image URI
                    attributes: [
                        {
                            trait_type: "Generation",
                            value: "1"
                        }
                    ]
                };

                // Create transaction
                const transaction = new solanaWeb3.Transaction();
                
                // Add mint instruction
                const mintInstruction = new solanaWeb3.TransactionInstruction({
                    programId: new solanaWeb3.PublicKey(NFT_PROGRAM_ID),
                    keys: [
                        {
                            pubkey: solana.publicKey,
                            isSigner: true,
                            isWritable: true,
                        },
                        // Add other necessary account keys based on your program
                    ],
                    data: Buffer.from(JSON.stringify(metadata)),
                });

                // Add SOL transfer instruction for payment
                const transferInstruction = solanaWeb3.SystemProgram.transfer({
                    fromPubkey: solana.publicKey,
                    toPubkey: new solanaWeb3.PublicKey('YOUR_TREASURY_WALLET'), // Replace with your treasury wallet
                    lamports: MINT_PRICE * solanaWeb3.LAMPORTS_PER_SOL,
                });

                transaction.add(transferInstruction, mintInstruction);

                // Get latest blockhash
                const { blockhash } = await connection.getLatestBlockhash();
                transaction.recentBlockhash = blockhash;
                transaction.feePayer = solana.publicKey;

                // Sign and send transaction
                const signed = await solana.signTransaction(transaction);
                const signature = await connection.sendRawTransaction(signed.serialize());
                
                // Wait for confirmation
                await connection.confirmTransaction(signature);

                alert('NFT minted successfully!');

            } catch (err) {
                console.error(err);
                alert('Failed to mint NFT: ' + err.message);
            }
        }

        // Initialize connection when page loads
        initializeConnection();

        // Add event listeners
        document.getElementById('connect-wallet').addEventListener('click', connectWallet);
        document.getElementById('mint-button').addEventListener('click', mintNFT);
    </script>
</body>
</html> 